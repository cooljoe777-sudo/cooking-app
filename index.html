<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>献立 & ご飯計算アプリ</title>
    <style>
        body {
            font-family: sans-serif;
            text-align: center;
            background-color: #f0f8ff;
            margin: 0;
            padding: 20px;
            color: #333;
        }
        h1 {
            font-size: 24px;
            margin-bottom: 20px;
        }
        
        #main-menu {
            max-width: 400px;
            margin: 0 auto;
        }

        /* --- アプリの目的などのテキストエリア --- */
        .intro-section {
            background: #fff;
            padding: 15px;
            border: 1px solid #ccc; /* 影をなくしシンプルな線にしました */
            text-align: left;
            margin-bottom: 20px;
            font-size: 14px;
        }

        /* --- ボタンのスタイル（大きさとはみ出し防止のみ適用） --- */
        button {
            font-size: 18px;
            padding: 15px;
            margin: 10px auto;
            width: 90%;
            max-width: 350px; /* PCではみ出しすぎないように */
            display: block;
            cursor: pointer;
        }

        /* 戻るボタン（上と下） */
        .btn-back {
            background-color: #999;
            color: white;
            padding: 10px;
            font-size: 16px;
        }

        /* --- 画面切り替え用 --- */
        .hidden { display: none; }

        /* --- 食材リストの表示（表のように整列） --- */
        .category-box {
            background: #fff;
            margin-bottom: 20px;
            padding: 10px;
            border: 1px solid #ccc;
        }
        .category-title {
            background: #eee;
            padding: 5px;
            font-weight: bold;
            margin-bottom: 10px;
            text-align: left;
        }
        .ingredient-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(120px, 1fr)); /* 自動で列を整列 */
            gap: 5px;
            text-align: left;
        }
        .ingredient-item {
            display: block;
            padding: 5px;
            border: 1px solid #eee;
        }

        /* --- ご飯計算リスト --- */
        .rice-list {
            list-style: none;
            padding: 0;
            max-width: 400px;
            margin: 0 auto;
            text-align: left;
        }
        .rice-list li {
            background: white;
            margin: 5px 0;
            padding: 10px;
            border-bottom: 1px solid #ccc;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        
        /* 名前入力欄 */
        .name-input {
            font-size: 16px;
            padding: 5px;
            width: 120px;
        }
        
        /* グラム直接入力欄（+-ボタンは廃止） */
        .gram-input {
            font-size: 18px;
            padding: 5px;
            width: 80px;
            text-align: right;
        }
    </style>
</head>
<body>

    <div id="main-menu">
        <h1>ホーム画面</h1>

        <div class="intro-section">
            <h3>アプリの目的</h3>
            <p><strong>キッカケ:</strong> 毎日の献立作りと計算の負担を減らすため。</p>
            <p><strong>目的:</strong> 職員の判断を補助し、スムーズな調理準備をするための道具。</p>
            <p><strong>アドバイス:</strong> AI検索は便利ですが、在庫に合わせて量は人間が調整してください。</p>
        </div>

        <button onclick="showScreen('meal-planning')">献立を考える</button>
        <button onclick="showScreen('rice-calculation')">ご飯の量を計算</button>
    </div>

    <div id="meal-planning" class="hidden">
        <button class="btn-back" onclick="showMainMenu()">トップに戻る</button>

        <h2>冷蔵庫にあるものは？</h2>
        
        <div style="margin-bottom: 15px;">
            <button style="display:inline-block; width:auto; padding:10px;" onclick="toggleAll(true)">全選択</button>
            <button style="display:inline-block; width:auto; padding:10px;" onclick="toggleAll(false)">全解除</button>
        </div>

        <form id="ingredient-form">
            <div class="category-box">
                <div class="category-title">食材リスト</div>
                <div class="ingredient-grid">
                    <label class="ingredient-item"><input type="checkbox" name="food" value="豚肉"> 豚肉</label>
                    <label class="ingredient-item"><input type="checkbox" name="food" value="鶏肉"> 鶏肉</label>
                    <label class="ingredient-item"><input type="checkbox" name="food" value="キャベツ"> キャベツ</label>
                    <label class="ingredient-item"><input type="checkbox" name="food" value="玉ねぎ"> 玉ねぎ</label>
                    <label class="ingredient-item"><input type="checkbox" name="food" value="人参"> 人参</label>
                    <label class="ingredient-item"><input type="checkbox" name="food" value="じゃがいも"> じゃがいも</label>
                    <label class="ingredient-item"><input type="checkbox" name="food" value="卵"> 卵</label>
                    <label class="ingredient-item"><input type="checkbox" name="food" value="豆腐"> 豆腐</label>
                    </div>
            </div>
        </form>

        <button onclick="generateMenu()">献立を提案する！</button>
        
        <button onclick="googleSearch()">Googleで検索する</button>
        
        <button class="btn-back" onclick="showMainMenu()">トップに戻る</button>
    </div>

    <div id="rice-calculation" class="hidden">
        <button class="btn-back" onclick="showMainMenu()">トップに戻る</button>

        <h2>ご飯の量を計算</h2>
        <ul id="member-list" class="rice-list">
            </ul>
        
        <div style="background: #fff; padding: 15px; margin-top: 20px; border:1px solid #ccc;">
            <h3 style="margin:0 0 10px 0;">合計: <span id="total-rice" style="font-size: 24px;">0</span> g</h3>
            <p>（約 <span id="total-gou">0.0</span> 合）</p>
        </div>

        <button onclick="calculateRice()">計算する</button>
        
        <button class="btn-back" onclick="showMainMenu()">トップに戻る</button>
    </div>

    <script>
        // --- データ初期設定 ---
        const defaultMembers = [
            { id: 'userA', name: '利用者A', amount: 150 },
            { id: 'userB', name: '利用者B', amount: 150 },
            { id: 'userC', name: '利用者C', amount: 150 },
            { id: 'userD', name: '利用者D', amount: 150 },
            { id: 'userE', name: '利用者E', amount: 100 },
            { id: 'userF', name: '利用者F', amount: 100 },
            { id: 'userG', name: '利用者G', amount: 200 },
            { id: 'userH', name: '利用者H', amount: 200 },
            { id: 'staff1', name: '職員1', amount: 200 },
            { id: 'staff2', name: '職員2', amount: 200 },
        ];

        window.onload = function() {
            renderRiceList();
        };

        function showScreen(screenId) {
            document.getElementById('main-menu').classList.add('hidden');
            document.getElementById('meal-planning').classList.add('hidden');
            document.getElementById('rice-calculation').classList.add('hidden');
            document.getElementById(screenId).classList.remove('hidden');
            window.scrollTo(0, 0);
        }

        function showMainMenu() {
            showScreen('main-menu');
        }

        // --- 献立機能 ---
        function toggleAll(isChecked) {
            const checkboxes = document.querySelectorAll('input[name="food"]');
            checkboxes.forEach(cb => cb.checked = isChecked);
        }

        // 献立を提案するボタン（現状は検索と同じ動作だが、将来的に機能を分けるため関数を分離）
        function generateMenu() {
            googleSearch(); 
        }

        // Google検索機能
        function googleSearch() {
            const checkboxes = document.querySelectorAll('input[name="food"]:checked');
            if (checkboxes.length === 0) {
                alert("食材が選択されていません");
                return;
            }

            let query = "";
            checkboxes.forEach((cb) => {
                query += cb.value + " ";
            });
            
            const url = `https://www.google.com/search?q=${encodeURIComponent(query + "レシピ 献立")}`;
            window.open(url, '_blank');
        }

        // --- ご飯計算機能（直接入力・計算ボタン式） ---
        function renderRiceList() {
            const listContainer = document.getElementById('member-list');
            listContainer.innerHTML = '';

            defaultMembers.forEach((member, index) => {
                const li = document.createElement('li');
                li.innerHTML = `
                    <input type="text" class="name-input" value="${member.name}" id="name-${index}">
                    <div style="display:flex; align-items:center;">
                        <input type="number" class="gram-input" value="${member.amount}" id="amount-${index}">
                        <span style="margin-left:5px;">g</span>
                    </div>
                `;
                listContainer.appendChild(li);
            });
            calculateRice();
        }

        function calculateRice() {
            let total = 0;
            // 画面に入力されている値を全て取得して計算
            defaultMembers.forEach((member, index) => {
                const inputVal = document.getElementById(`amount-${index}`).value;
                let val = parseInt(inputVal);
                if (isNaN(val) || val < 0) val = 0;
                
                // データ自体も更新しておく
                defaultMembers[index].amount = val;
                total += val;
            });
            
            document.getElementById('total-rice').innerText = total;
            const gou = (total / 330).toFixed(1);
            document.getElementById('total-gou').innerText = gou;
        }
    </script>
</body>
</html>
